"use strict";(globalThis.webpackChunknew_blishhud_com=globalThis.webpackChunknew_blishhud_com||[]).push([[6773],{2119(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>d});var t=s(4848),o=s(8453);const i={id:"anatomy",title:"Anatomy of a Module"},r=void 0,a={id:"modules/overview/anatomy",title:"Anatomy of a Module",description:"Blish HUD instantiates module classes when a user enables the module. The sections below explain what the class provides and how to use each part.",source:"@site/docs/modules/overview/anatomy.md",sourceDirName:"modules/overview",slug:"/modules/overview/anatomy",permalink:"/docs/modules/overview/anatomy",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"anatomy",title:"Anatomy of a Module"},sidebar:"DevGuides",previous:{title:"Debugging Your Module",permalink:"/docs/modules/overview/debugging"},next:{title:".bhm Package",permalink:"/docs/modules/overview/bhm"}},l={},d=[{value:"The Logger",id:"the-logger",level:3},{value:"Module Parameters",id:"module-parameters",level:3},{value:"The Constructor",id:"the-constructor",level:3},{value:"Define Your Settings",id:"define-your-settings",level:3},{value:"Display Your Settings",id:"display-your-settings",level:3},{value:"Load Your Module",id:"load-your-module",level:3},{value:"Update Your Module",id:"update-your-module",level:3},{value:"Unload Your Module",id:"unload-your-module",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Blish HUD instantiates module classes when a user enables the module. The sections below explain what the class provides and how to use each part."}),"\n",(0,t.jsx)(n.h3,{id:"the-logger",children:"The Logger"}),"\n",(0,t.jsx)(n.p,{children:"The logger is typically the first line of most modules and gives your module a logger instance. Create a logger the same way in any class where you need one."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"private static readonly Logger Logger = Logger.GetLogger<YourModule>();\n"})}),"\n",(0,t.jsx)(n.h3,{id:"module-parameters",children:"Module Parameters"}),"\n",(0,t.jsxs)(n.p,{children:["When your module is instantiated, it receives module parameters for common tasks (assigned to the module's ",(0,t.jsx)(n.code,{children:"ModuleParameters"})," property). These currently are:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"SettingsManager"})," - Used to define your settings."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"ContentsManager"})," - Used to load data from your ref directory that was bundled with the module."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"DirectoriesManager"})," - Used to access the directories listed in your manifest."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Gw2ApiManager"})," - Used to make, potentially, authenticated calls to the Guild Wars 2 web API."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"the-constructor",children:"The Constructor"}),"\n",(0,t.jsxs)(n.p,{children:["The constructor and its ",(0,t.jsx)(n.code,{children:"ImportingConstructor"})," attribute tell Blish HUD which class to instantiate when the module is enabled. Because Blish HUD does not use dependency injection, you may find it convenient to assign ",(0,t.jsx)(n.code,{children:"this"})," to a static ",(0,t.jsx)(n.code,{children:"Instance"})," variable on the module."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'[ImportingConstructor]\npublic YourModule([Import("ModuleParameters")] ModuleParameters moduleParameters) : base(moduleParameters) {\n    /* ... */\n}\n'})}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["This call blocks and often runs before other parts of Blish HUD are ready. Avoid loading resources here and limit the work to basic initialization, such as assigning the static ",(0,t.jsx)(n.code,{children:"Instance"}),"."]})}),"\n",(0,t.jsx)(n.h3,{id:"define-your-settings",children:"Define Your Settings"}),"\n",(0,t.jsxs)(n.p,{children:["Use this method to define any settings your module needs (see our ",(0,t.jsx)(n.a,{href:"/docs/modules/guides/settings",children:"guide on settings"}),")."]}),"\n",(0,t.jsx)(n.p,{children:"When defining your settings:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\u2705 ",(0,t.jsx)(n.strong,{children:"DO"})," use a dedicated settings class when you have many settings to keep the module class manageable."]}),"\n",(0,t.jsxs)(n.li,{children:["\u2705 ",(0,t.jsx)(n.strong,{children:"DO"})," use localized strings so users can understand your settings regardless of their Blish HUD language."]}),"\n",(0,t.jsxs)(n.li,{children:["\u274c ",(0,t.jsx)(n.strong,{children:"DO NOT"})," perform anything other than defining settings in this call. It blocks and should not access external resources or perform heavy work."]}),"\n",(0,t.jsxs)(n.li,{children:["\u274c ",(0,t.jsx)(n.strong,{children:"DO NOT"})," change the data types of settings after they are defined. Doing so can discard saved values. Migrate settings on launch or use a new setting name instead."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"It is not required that you define all settings at launch.  Settings can be defined or recalled at any time within your module."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'protected override void DefineSettings(SettingCollection settings) {\n    _settingOnlyShowAtHighSpeeds = settings.DefineSetting("OnlyShowAtHighSpeeds", false, () => "Only Show at High Speeds", () => "Only show the speedometer if you\'re going at least 1/4 the max speed.");\n    _settingShowSpeedNumber      = settings.DefineSetting("ShowSpeedNumber",      false, () => "Show Speed Value",         () => "Shows the speed (in approx. inches per second) above the speedometer.");\n\n    _appearanceSettings      = settings.AddSubCollection("Appearance", true);\n    _settingShowWithSparkles = _appearanceSettings.DefineSetting("ShowWithSparkles", true, () => "Show Sparkles", () => "If enabled, sparkles will be shown on the speedometer.");\n    _settingSparkleCount     = _appearanceSettings.DefineSetting("SparkleCount",     5,    () => "Sparkle Count", () => "The number of sparkles to show on the speedometer if \'Show Sparkles\' is enabled.");\n\n    _settingSparkleCount.SetRange(1, 10);\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"display-your-settings",children:"Display Your Settings"}),"\n",(0,t.jsxs)(n.p,{children:["By default, settings with proper display names automatically appear through the ",(0,t.jsx)(n.code,{children:"SettingsView"})," renderers. The default implementation generates fully wired controls for you on the module page in Blish HUD."]}),"\n",(0,t.jsx)(n.p,{children:"If you prefer a more tailored settings layout or want to surface settings in another window, provide a custom view."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"public override IView GetSettingsView() {\n    return new SettingsHintView();\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"If you do not override this function, Blish HUD uses the built-in settings display."}),"\n",(0,t.jsx)(n.h3,{id:"load-your-module",children:"Load Your Module"}),"\n",(0,t.jsx)(n.p,{children:"Your module can load asynchronously when it is first enabled. While loading, the module page shows the in-progress state. Use this call to load resources such as textures or web data so they are ready when the module runs."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"protected override async Task LoadAsync() {\n    await LoadTheThings();\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"update-your-module",children:"Update Your Module"}),"\n",(0,t.jsxs)(n.p,{children:["Your module receives an ",(0,t.jsx)(n.code,{children:"Update"})," call every frame before rendering. Keep the work in this loop minimal. Blish HUD locks update and rendering together, so rendering cannot occur until updates finish."]}),"\n",(0,t.jsxs)(n.p,{children:["Update calls block other modules and rendering. If you have long-running processes, move them to their own thread or use the ",(0,t.jsx)(n.code,{children:"gameTime"})," parameter to run calculations intermittently instead of every frame."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"protected override void Update(GameTime gameTime) {\n    // Do something\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"unload-your-module",children:"Unload Your Module"}),"\n",(0,t.jsx)(n.p,{children:"Cleaning up after yourself is essential to being a good module citizen. Remove static references and dispose of UI elements, textures, and other resources."}),"\n",(0,t.jsx)(n.p,{children:"Users and Blish HUD processes (such as automatic updates) can disable and enable your module many times per session. To avoid memory leaks or other unintended behavior, reverse as much of your setup work as possible when unloading."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"protected override void Unload() {\n    this.PackInitiator?.Unload();\n    _pathingIcon?.Dispose();\n    _settingsWindow?.Dispose();\n\n    Instance = null;\n}\n"})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453(e,n,s){s.d(n,{R:()=>r,x:()=>a});var t=s(6540);const o={},i=t.createContext(o);function r(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);